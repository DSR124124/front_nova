<div class="chat-container">
  <!-- Header del chat -->
  <div class="chat-header">
    <h2 class="chat-title">
      <i class="pi pi-comments"></i>
      Chat
    </h2>
    <p class="chat-subtitle">Conversa con tus contactos</p>
  </div>

  <!-- Contenido principal del chat -->
  <div class="chat-content">
    <!-- Panel izquierdo - Lista de contactos -->
    <div class="chat-sidebar">
      <div class="sidebar-header">
        <h4>Contactos</h4>
        <span class="contact-count">{{ contacts.length }} contactos</span>
      </div>

      <div class="contacts-list">
        <div
          *ngFor="let contact of contacts"
          class="contact-item"
          [class.active]="currentContact?.id === contact.id"
          (click)="selectContact(contact)">

          <div class="contact-avatar">
            <i class="pi pi-user"></i>
            <span
              class="status-indicator"
              [class]="'status-' + contact.status">
            </span>
          </div>

          <div class="contact-info">
            <div class="contact-name">{{ contact.name }}</div>
            <div class="contact-status">
              <span *ngIf="contact.status === 'online'">En línea</span>
              <span *ngIf="contact.status === 'away'">Ausente</span>
              <span *ngIf="contact.status === 'offline'">Desconectado</span>
            </div>
          </div>

          <div class="contact-meta" *ngIf="contact.unreadCount > 0">
            <span class="unread-badge">{{ contact.unreadCount }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel derecho - Área de mensajes -->
    <div class="chat-main">
      <!-- Header del contacto actual -->
      <div *ngIf="currentContact" class="contact-header">
        <div class="contact-header-content">
          <i class="pi pi-user"></i>
          <div class="contact-header-info">
            <h4>{{ currentContact.name }}</h4>
            <span class="status-tag" [class]="'status-' + currentContact.status">
              {{ currentContact.status === 'online' ? 'En línea' : 'Desconectado' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Área de mensajes -->
      <div class="messages-area">
        <!-- Estado sin contacto seleccionado -->
        <div *ngIf="!currentContact" class="no-contact-selected">
          <i class="pi pi-comment"></i>
          <h3>Selecciona un contacto</h3>
          <p>Elige un contacto para comenzar a chatear</p>
        </div>

        <!-- Componente de lista de mensajes -->
        <app-message-list
          *ngIf="currentContact"
          [messages]="messages"
          [currentUserId]="currentUserId"
          [loading]="loading"
          [emptyStateMessage]="'Sin mensajes'"
          [emptyStateSubMessage]="'Inicia la conversación con ' + currentContact.name"
          (messageDeleted)="deleteMessage($event)"
          (messageRead)="onMessageRead($event)">
        </app-message-list>
      </div>

      <!-- Input para enviar mensajes -->
      <div class="message-input-area" *ngIf="currentContact">
        <app-message-input
          [placeholder]="'Escribe un mensaje...'"
          [maxLength]="500"
          [allowAttachments]="true"
          [allowEmojis]="true"
          [showCharacterCount]="true"
          [disabled]="loading"
          (messageSent)="onMessageSent($event)"
          (typingStarted)="onTypingStarted()"
          (typingStopped)="onTypingStopped()">
        </app-message-input>
      </div>
    </div>
  </div>

  <!-- Toast para notificaciones -->
  <p-toast position="top-right" />
</div>
