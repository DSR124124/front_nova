<p-card>
  <ng-template pTemplate="header">
    <div class="forgot-password-header">
      <h2>Recuperar Contraseña</h2>
      <p *ngIf="!emailSent">Ingresa tu email para recibir un enlace de recuperación</p>
    </div>
  </ng-template>

  <ng-template pTemplate="content">
    <!-- Formulario de email -->
    <div *ngIf="!emailSent">
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
        <div class="form-field">
          <p-floatlabel>
            <input
              pInputText
              id="email"
              formControlName="email"
              [class.ng-invalid]="isFieldInvalid('email')"
              type="email"
            />
            <label for="email">Correo Electrónico</label>
          </p-floatlabel>
          <small
            *ngIf="isFieldInvalid('email')"
            class="p-error"
          >
            {{ getFieldError('email') }}
          </small>
        </div>

        <div class="form-actions">
          <p-button
            type="submit"
            label="Enviar Enlace de Recuperación"
            [loading]="loading"
            [disabled]="forgotPasswordForm.invalid"
            styleClass="w-full"
          />
        </div>
      </form>
    </div>

    <!-- Mensaje de confirmación -->
    <div *ngIf="emailSent" class="email-sent-container">
      <div class="success-icon">
        <i class="pi pi-check-circle"></i>
      </div>
      <h3>¡Email Enviado!</h3>
      <p>
        Hemos enviado un enlace de recuperación a tu correo electrónico.
        Revisa tu bandeja de entrada y sigue las instrucciones.
      </p>
      <p-message
        severity="info"
        text="Si no recibes el email en unos minutos, revisa tu carpeta de spam."
      />

      <div class="resend-section">
        <p>¿No recibiste el email?</p>
        <p-button
          label="Reenviar Email"
          [loading]="loading"
          (onClick)="resendEmail()"
          styleClass="p-button-text"
        />
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <div class="forgot-password-footer">
      <p-button
        label="Volver al Login"
        link="true"
        (onClick)="onBackToLogin()"
        icon="pi pi-arrow-left"
      />
    </div>
  </ng-template>
</p-card>

<p-toast />
