<!-- Header de la Landing Page -->
<app-header></app-header>

<!-- Contenido del Login -->
<div class="login-form-container">

  <!-- Header -->
  <div class="form-header">
    <h2 class="form-title">
      Iniciar Sesión
    </h2>
  </div>

  <!-- Loading Spinner -->
  <app-loading-spinner *ngIf="loading" label="Iniciando sesión..." size="medium" [overlay]="false" />

  <!-- Formulario -->
  <div class="form-wrapper" *ngIf="!loading">
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">


      <!-- Usuario -->
      <div class="form-field">
        <label for="username" class="field-label">
          Usuario <span class="required">*</span>
        </label>
        <input
          type="text"
          pInputText
          id="username"
          formControlName="username"
          placeholder="Ingresa tu nombre de usuario"
          [class.field-error]="isFieldInvalid('username')"
          class="field-input"
          autocomplete="username"
        />
        <small *ngIf="isFieldInvalid('username')" class="error-message">
          <i class="pi pi-exclamation-circle"></i>
          {{ getFieldError('username') }}
        </small>
      </div>

      <!-- Contraseña -->
      <div class="form-field">
        <label for="password" class="field-label">
          Contraseña <span class="required">*</span>
        </label>
        <div class="password-input-container">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            placeholder="Ingresa tu contraseña"
            [class.field-error]="isFieldInvalid('password')"
            class="field-input password-input"
            autocomplete="current-password"
          />
          <button
            type="button"
            class="password-toggle-btn"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'"
          >
            <i [class]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
          </button>
        </div>
        <small *ngIf="isFieldInvalid('password')" class="error-message">
          <i class="pi pi-exclamation-circle"></i>
          {{ getFieldError('password') }}
        </small>
      </div>

      <!-- Recordarme -->
      <div class="form-field">
        <div class="remember-me-checkbox">
          <p-checkbox [(ngModel)]="rememberMe" [ngModelOptions]="{standalone: true}" inputId="rememberMe"
            [binary]="true" />
          <label for="rememberMe" class="p-checkbox-label">
            Recordarme
          </label>
        </div>
      </div>

      <!-- Botones de acción -->
      <div class="form-actions">
        <p-button type="button" label="¿Olvidaste tu contraseña?" severity="secondary" icon="pi pi-question-circle"
          [outlined]="true" (onClick)="onForgotPassword()" styleClass="cancel-btn" />

        <p-button type="submit" label="Iniciar Sesión" icon="pi pi-sign-in" [loading]="loading"
          [disabled]="loginForm.invalid" styleClass="submit-btn" />
      </div>
    </form>
  </div>

  <!-- Enlaces adicionales -->
  <div class="additional-links">
    <p-button label="Crear cuenta nueva" link="true" icon="pi pi-user-plus" (onClick)="onRegister()"
      styleClass="link-btn" />
  </div>
</div>

<!-- Footer de la Landing Page -->
<app-footer></app-footer>

<!-- Toast para mensajes -->
<p-toast />
