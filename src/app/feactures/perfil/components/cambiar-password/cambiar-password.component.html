<div class="cambiar-password-container">

  <!-- Información de seguridad -->
  <p-card header="Cambiar Contraseña" styleClass="security-card">
    <p-message
      severity="info"
      text="Por tu seguridad, te pediremos tu contraseña actual antes de establecer una nueva">
    </p-message>

    <!-- Formulario de cambio de contraseña -->
    <form [formGroup]="cambiarPasswordForm" (ngSubmit)="cambiarPassword()" class="password-form">

      <!-- Contraseña actual -->
      <div class="field-container">
        <label for="passwordActual">Contraseña Actual</label>
        <p-password
          id="passwordActual"
          formControlName="passwordActual"
          placeholder="Ingresa tu contraseña actual"
          [toggleMask]="true"
          [feedback]="false"
          styleClass="w-full"
          [class.ng-invalid]="passwordActual?.invalid && passwordActual?.touched">
        </p-password>
        <small
          *ngIf="getErrorMessage('passwordActual')"
          class="error-message">
          {{ getErrorMessage('passwordActual') }}
        </small>
      </div>

      <!-- Nueva contraseña -->
      <div class="field-container">
        <label for="passwordNueva">Nueva Contraseña</label>
        <p-password
          id="passwordNueva"
          formControlName="passwordNueva"
          placeholder="Ingresa tu nueva contraseña"
          [toggleMask]="true"
          [feedback]="true"
          styleClass="w-full"
          [class.ng-invalid]="passwordNueva?.invalid && passwordNueva?.touched">
        </p-password>

        <!-- Indicador de fortaleza personalizado -->
        <div *ngIf="passwordNueva?.value" class="strength-indicator">
          <div class="strength-bar">
            <div
              class="strength-fill"
              [style.width.%]="fortalezaPassword.score"
              [ngClass]="'strength-' + fortalezaPassword.color">
            </div>
          </div>
          <p-tag
            [value]="fortalezaPassword.mensaje"
            [severity]="fortalezaPassword.color"
            styleClass="strength-tag">
          </p-tag>
        </div>

        <small
          *ngIf="getErrorMessage('passwordNueva')"
          class="error-message">
          {{ getErrorMessage('passwordNueva') }}
        </small>
      </div>

      <!-- Confirmar nueva contraseña -->
      <div class="field-container">
        <label for="passwordConfirmar">Confirmar Nueva Contraseña</label>
        <p-password
          id="passwordConfirmar"
          formControlName="passwordConfirmar"
          placeholder="Confirma tu nueva contraseña"
          [toggleMask]="true"
          [feedback]="false"
          styleClass="w-full"
          [class.ng-invalid]="passwordConfirmar?.invalid && passwordConfirmar?.touched">
        </p-password>
        <small
          *ngIf="getErrorMessage('passwordConfirmar')"
          class="error-message">
          {{ getErrorMessage('passwordConfirmar') }}
        </small>
      </div>

      <!-- Consejos de seguridad -->
      <div class="security-tips">
        <h5>Consejos para una contraseña segura:</h5>
        <ul>
          <li>Usa al menos 8 caracteres</li>
          <li>Incluye letras mayúsculas y minúsculas</li>
          <li>Agrega números y símbolos</li>
          <li>Evita información personal</li>
          <li>No reutilices contraseñas de otras cuentas</li>
        </ul>
      </div>

      <!-- Botones de acción -->
      <div class="form-actions">
        <p-button
          label="Cambiar Contraseña"
          icon="pi pi-save"
          type="submit"
          [loading]="loading"
          [disabled]="cambiarPasswordForm.invalid"
          styleClass="p-button-success">
        </p-button>

        <p-button
          label="Cancelar"
          icon="pi pi-times"
          type="button"
          (onClick)="cancelar()"
          styleClass="p-button-outlined">
        </p-button>
      </div>
    </form>
  </p-card>

  <!-- Información adicional de seguridad -->
  <p-card header="Información de Seguridad" styleClass="info-card">
    <div class="security-info">
      <div class="info-item">
        <i class="pi pi-shield" style="color: var(--primary-color)"></i>
        <div>
          <h6>Contraseña Segura</h6>
          <p>Una contraseña fuerte protege tu cuenta de accesos no autorizados.</p>
        </div>
      </div>

      <div class="info-item">
        <i class="pi pi-clock" style="color: var(--primary-color)"></i>
        <div>
          <h6>Cambio Regular</h6>
          <p>Te recomendamos cambiar tu contraseña cada 3-6 meses.</p>
        </div>
      </div>

      <div class="info-item">
        <i class="pi pi-eye-slash" style="color: var(--primary-color)"></i>
        <div>
          <h6>Mantén la Privacidad</h6>
          <p>Nunca compartas tu contraseña con otras personas.</p>
        </div>
      </div>
    </div>
  </p-card>

  <!-- Toast para mensajes -->
  <p-toast position="top-right" />

</div>
