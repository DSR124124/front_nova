<div class="stats-widget-container">

  <!-- Header del widget -->
  <div class="widget-header">
    <h4 class="text-xl font-semibold text-900">{{ title }}</h4>
    <p-button
      *ngIf="loading"
      icon="pi pi-spin pi-spinner"
      [text]="true"
      [rounded]="true"
      size="small"
      disabled
    />
  </div>

  <!-- Contenido del widget -->
  <div class="widget-content">

    <!-- Estado de carga -->
    <div *ngIf="loading" class="text-center p-4">
      <p-progressSpinner
        styleClass="w-4rem h-4rem"
        strokeWidth="4"
        fill="var(--surface-card)"
        animationDuration=".5s">
      </p-progressSpinner>
      <p class="text-600 mt-3">Cargando estadísticas...</p>
    </div>

    <!-- Lista vacía -->
    <div *ngIf="!loading && stats.length === 0" class="text-center p-4">
      <i class="pi pi-chart-bar text-4xl text-500 mb-3"></i>
      <p class="text-900 font-semibold">No hay estadísticas disponibles</p>
      <small class="text-600">Los datos aparecerán aquí cuando estén disponibles</small>
    </div>

    <!-- Estadísticas -->
    <div *ngIf="!loading && stats.length > 0" class="stats-grid">
      <div
        *ngFor="let stat of stats; trackBy: trackByStat"
        class="stat-item"
      >

        <!-- Icono -->
        <div class="stat-icon" [style.color]="stat.color">
          <i [class]="stat.icon"></i>
        </div>

        <!-- Contenido -->
        <div class="stat-content">
          <div class="stat-value text-900">{{ formatValue(stat.value) }}</div>
          <div class="stat-label text-600">{{ stat.label }}</div>

          <!-- Tendencia -->
          <div *ngIf="showTrends && stat.trend" class="stat-trend">
            <i [class]="getTrendIcon(stat.trend)" [class]="'trend-' + stat.trend"></i>
            <span *ngIf="stat.trendValue" class="trend-value">{{ stat.trendValue }}%</span>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
